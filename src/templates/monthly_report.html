{% extends "base.html" %}

{% block title %}月次レポート - 勤怠管理システム{% endblock %}

{% block content %}
<div class="card">
    <h2>月次レポート</h2>
    
    <div style="margin: 20px 0;">
        <form method="GET" action="{{ url_for('monthly_report') }}" style="display: flex; gap: 10px; align-items: center;">
            <label for="year">年:</label>
            <input type="number" id="year" name="year" value="{{ year }}" min="2020" max="2100" style="width: 100px;">
            <label for="month">月:</label>
            <select id="month" name="month" style="width: 100px;">
                {% for m in range(1, 13) %}
                <option value="{{ m }}" {% if month == m %}selected{% endif %}>{{ m }}月</option>
                {% endfor %}
            </select>
            <button type="submit" class="btn">表示</button>
        </form>
    </div>
    
    <div style="margin: 20px 0;">
        <h3>{{ year }}年{{ month }}月の勤怠レポート</h3>
    </div>
    
    {% if report_data %}
    <table>
        <thead>
            <tr>
                <th>社員名</th>
                <th>出勤日数</th>
                <th>総労働時間（時間）</th>
                <th>総休憩時間（時間）</th>
                <th>実労働時間（時間）</th>
            </tr>
        </thead>
        <tbody>
            {% for data in report_data %}
            <tr>
                <td>{{ data.employee_name }}</td>
                <td>{{ data.attendance_days or 0 }}</td>
                <td>{{ "%.2f"|format(data.total_hours or 0) }}</td>
                <td>{{ "%.2f"|format(data.total_break_hours or 0) }}</td>
                <td>{{ "%.2f"|format((data.total_hours or 0) - (data.total_break_hours or 0)) }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="padding: 20px; color: #666;">該当期間のデータがありません。</p>
    {% endif %}
</div>
{% endblock %}

